# CLAUDE.md

* 遵循 KISS 原则，非必要不要过度设计，避免不必要的复杂性
* 精益求精(YAGNI原则)：仅实现当前明确所需的功能，抵制过度设计和不必要的未来特性预留
* 坚实基础(SOLID原则)：遵循面向对象设计的基本原则，确保代码的模块化、可维护性和可扩展性
* 杜绝重复(DRY原则)：识别并消除代码或逻辑中的重复模式，提升复用性
* 你需要逐步进行，通过多轮对话来完成需求，进行渐进式开发
* 在开始设计方案或实现代码之前，你需要进行充分的调研。如果有任何不明确的要求，请在继续之前向我确认
* 当你收到一个需求时，首先需要思考相关的方案，并请求我进行审核。通过审核后，需要将相应的任务拆解到 TODO 中
* 优先使用工具解决问题
* 从最本质的角度，用第一性原理来分析问题
* 尊重事实比尊重我更为重要。如果我犯错，请毫不犹豫地指正我，以便帮助我提高
* 如果文件路径不确定，先查找文件，确定文件路径后再读取

## 语言倾向
  - 总是使用简体中文回答问题

## Tool Usage Strategy
 - 严禁猜测代码位置。必须使用工具获取确切的符号关系和定义。
 - 优先使用工具解决问题，避免盲目猜测和假设。
 - 在进行代码阅读和修改前，务必先通过工具确认符号关系和定义，避免误操作。
 - 在进行代码修改时，务必先通过工具分析影响范围，避免破坏现有功能。

## 文档概览

1. docs/REWRITE.md (重写方案文档)

包含以下内容：
- 项目概况分析 - 原 Node.js 项目的技术栈和核心功能
- 技术栈选型 - 确定使用 Gin + Bun + go-redis 等
- 项目目录结构 - 完整的 Go 项目目录设计
- 模块依赖关系图 - 清晰的模块依赖层次
- 核心模块映射 - Node.js 模块到 Go 模块的对应关系
- 分阶段实现计划 - 6 个阶段的详细任务清单
- 测试与验证策略 - 单元测试、集成测试、E2E 测试
- API 兼容性要求 - 100% 兼容现有 API
- 里程碑检查点 - 7 个关键里程碑

2. docs/SPEC.md (技术规范文档)

包含以下内容：
- 数据模型规范 - User、Key、Provider、MessageRequest、ModelPrice 的完整 Go 结构体定义
- 配置规范 - 环境变量和配置结构体定义
- API 规范 - 代理 API 和管理 API 的请求/响应格式
- 错误码规范 - HTTP 状态码和错误响应格式
- 限流规范 - 多维度限流的 Redis Key 设计和 Lua 脚本
- 熔断器规范 - 状态机和 Redis 状态存储
- 会话管理规范 - Session 结构和并发控制
- 日志规范 - 日志格式和级别定义
- 接口定义 - Repository、Service、Proxy 接口设计
- 性能指标 - 目标指标和监控指标
- 安全规范 - 敏感数据处理和请求验证